<%

function getGenres(book) {
    var genres = book.genre;
    var result = [];

    Object.keys(genres).forEach(function(key){

        result = result.concat(genres[key]);
    });

    return result;
}
function getContent(book) {
    var content = book.content;
    var result = [];

    Object.keys(content).forEach(function(key){
        result = result.concat(content[key]);
    });

    return result;
}

%>

<div class="main">
<!--    TODO-->
    <% if(book.is_new) { %>
        <span class="label label-danger badge-new">Нова</span>
    <% } else if(book.is_popular) {%>
        <span class="label label-success badge-new">Популярна</span>
    <% } %>
<!--!TODO    -->
    <div class="book-name"><%= book.title %></div>
    <hr class="featurette">
    <div class="main-info clearfix">
        <img src="<%= book.icon %>" class="cover">
        <div class="info">
            <div class="group">
                <div class="name author">Автор</div>
                <div class="inf author"><%= book.author %></div>
            </div>
            <div class="group">
                <div class="name genre">Жанр</div>
                <div class="inf genre"> <%= getGenres(book).join(", ") %></div>
            </div>
            <div class="group">
                <div class="name status">Статус</div>
                <% if(book.status == "Завершено"){ %>
                    <div class="inf status finished"></div>
                <% }else if(book.status == "У процесі"){ %>
                    <div class="inf status during"></div>
                <% }else if(book.status == "Заморожено"){ %>
                    <div class="inf status frozen"></div>
                <% }else { %>
                    <div class="inf status finished"></div>
                <% } %>
            </div>
            <% if(book.cycle) { %>
            <div class="group">
                    <div class="name cycle">Цикл</div>
                    <div class="inf cycle"><% book.cycle %></div>
            </div>
            <% } %>
            <% if(book.minAge) { %>
            <div class="group">
                <div class="name needed-age">Вікові обмеження</div>
                <div class="inf needed-age"><% book.minAge %></div>
            </div>
            <% } %>
        </div>
    </div>
    <hr class="featurette">
    <div class="group">
        <div class="name content">Опис</div>
        <div class="inform content"><% book.description %></div>
    </div>
    <% if(book.note) { %>
    <div class="group">
        <div class="name author-note">Примітка автора</div>
        <div class="inform author-note">
            <% book.note %>
        </div>
    </div>
    <% } %>
    <!--    TODO-->
    <% if(book.content) { %>
    <hr class="featurette">
    <div class="group">
        <div class="name table-cont">Зміст</div>
        getContent(book).forEach(function(key){
            <div class="table-cont part"> Try-1 __ <%= key %></div>
        });

        <div class="table-cont part">Try-2 __ <%= getContent(book).join(", ") %></div>
        <div class="table-cont part">Глава 2</div>
        <div class="table-cont part">Глава 3</div>
        <div class="table-cont part">Глава 4</div>
        <div class="table-cont part">Глава 5</div>
        <div class="table-cont part">Глава 6</div>
        <div class="table-cont part">Глава 7</div>
        <div class="table-cont part">Глава 8</div>
        <div class="table-cont part">Глава 9</div>
        <div class="table-cont part">Глава 10</div>
    </div>
    <div class="file">
        <a href="<%=book.file %>">a</a>
    </div>
    <% } %>
    <!-- !TODO-->
</div>